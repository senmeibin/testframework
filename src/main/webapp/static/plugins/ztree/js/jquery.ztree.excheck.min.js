(function(a){var f={event:{CHECK:"ztree_check"},id:{CHECK:"_check"},checkbox:{STYLE:"checkbox",DEFAULT:"chk",DISABLED:"disable",FALSE:"false",TRUE:"true",FULL:"full",PART:"part",FOCUS:"focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"}},p={check:{enable:false,autoCheckTrigger:false,chkStyle:f.checkbox.STYLE,nocheckInherit:false,chkDisabledInherit:false,radioType:f.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"}},data:{key:{checked:"checked"}},callback:{beforeCheck:null,onCheck:null}},n=function(C){var B=w.getRoot(C);B.radioCheckedList=[]},l=function(B){},e=function(D){var C=D.treeObj,B=v.event;C.bind(B.CHECK,function(E,G,H,F){E.srcEvent=G;y.apply(D.callback.onCheck,[E,H,F])})},r=function(D){var C=D.treeObj,B=v.event;C.unbind(B.CHECK)},j=function(B){var H=B.target,G=w.getSetting(B.data.treeId),I="",C=null,E="",K="",D=null,J=null;if(y.eqs(B.type,"mouseover")){if(G.check.enable&&y.eqs(H.tagName,"span")&&H.getAttribute("treeNode"+v.id.CHECK)!==null){I=y.getNodeMainDom(H).id;E="mouseoverCheck"}}else{if(y.eqs(B.type,"mouseout")){if(G.check.enable&&y.eqs(H.tagName,"span")&&H.getAttribute("treeNode"+v.id.CHECK)!==null){I=y.getNodeMainDom(H).id;E="mouseoutCheck"}}else{if(y.eqs(B.type,"click")){if(G.check.enable&&y.eqs(H.tagName,"span")&&H.getAttribute("treeNode"+v.id.CHECK)!==null){I=y.getNodeMainDom(H).id;E="checkNode"}}}}if(I.length>0){C=w.getNodeCache(G,I);switch(E){case"checkNode":D=k.onCheckNode;break;case"mouseoverCheck":D=k.onMouseoverCheck;break;case"mouseoutCheck":D=k.onMouseoutCheck;break}}var F={stop:E==="checkNode",node:C,nodeEventType:E,nodeEventCallback:D,treeEventType:K,treeEventCallback:J};return F},m=function(J,E,F,H,C,D,G){if(!F){return}var B=J.data.key.checked;if(typeof F[B]=="string"){F[B]=y.eqs(F[B],"true")}F[B]=!!F[B];F.checkedOld=F[B];if(typeof F.nocheck=="string"){F.nocheck=y.eqs(F.nocheck,"true")}F.nocheck=!!F.nocheck||(J.check.nocheckInherit&&H&&!!H.nocheck);if(typeof F.chkDisabled=="string"){F.chkDisabled=y.eqs(F.chkDisabled,"true")}F.chkDisabled=!!F.chkDisabled||(J.check.chkDisabledInherit&&H&&!!H.chkDisabled);if(typeof F.halfCheck=="string"){F.halfCheck=y.eqs(F.halfCheck,"true")}F.halfCheck=!!F.halfCheck;F.check_Child_State=-1;F.check_Focus=false;F.getCheckStatus=function(){return w.getCheckStatus(J,F)};if(J.check.chkStyle==v.radio.STYLE&&J.check.radioType==v.radio.TYPE_ALL&&F[B]){var I=w.getRoot(J);I.radioCheckedList.push(F)}},d=function(E,D,C){var B=E.data.key.checked;if(E.check.enable){w.makeChkFlag(E,D);C.push("<span ID='",D.tId,v.id.CHECK,"' class='",z.makeChkClass(E,D),"' treeNode",v.id.CHECK,(D.nocheck===true?" style='display:none;'":""),"></span>")}},u=function(C,D){D.checkNode=function(J,F,I,E){var G=this.setting.data.key.checked;if(J.chkDisabled===true){return}if(F!==true&&F!==false){F=!J[G]}E=!!E;if(J[G]===F&&!I){return}else{if(E&&y.apply(this.setting.callback.beforeCheck,[this.setting.treeId,J],true)==false){return}}if(y.uCanDo(this.setting)&&this.setting.check.enable&&J.nocheck!==true){J[G]=F;var H=b(J,v.id.CHECK,this.setting);if(I||this.setting.check.chkStyle===v.radio.STYLE){z.checkNodeRelation(this.setting,J)}z.setChkClass(this.setting,H,J);z.repairParentChkClassWithSelf(this.setting,J);if(E){this.setting.treeObj.trigger(v.event.CHECK,[null,this.setting.treeId,J])}}};D.checkAllNodes=function(E){z.repairAllChk(this.setting,!!E)};D.getCheckedNodes=function(E){var F=this.setting.data.key.children;E=(E!==false);return w.getTreeCheckedNodes(this.setting,w.getRoot(this.setting)[F],E)};D.getChangeCheckedNodes=function(){var E=this.setting.data.key.children;return w.getTreeChangeCheckedNodes(this.setting,w.getRoot(this.setting)[E])};D.setChkDisabled=function(H,E,G,F){E=!!E;G=!!G;F=!!F;z.repairSonChkDisabled(this.setting,H,E,F);z.repairParentChkDisabled(this.setting,H.getParentNode(),E,G)};var B=D.updateNode;D.updateNode=function(H,F){if(B){B.apply(D,arguments)}if(!H||!this.setting.check.enable){return}var G=b(H,this.setting);if(G.get(0)&&y.uCanDo(this.setting)){var E=b(H,v.id.CHECK,this.setting);if(F==true||this.setting.check.chkStyle===v.radio.STYLE){z.checkNodeRelation(this.setting,H)}z.setChkClass(this.setting,E,H);z.repairParentChkClassWithSelf(this.setting,H)}}},h={getRadioCheckedList:function(E){var B=w.getRoot(E).radioCheckedList;for(var C=0,D=B.length;C<D;C++){if(!w.getNodeCache(E,B[C].tId)){B.splice(C,1);C--;D--}}return B},getCheckStatus:function(E,C){if(!E.check.enable||C.nocheck||C.chkDisabled){return null}var B=E.data.key.checked,D={checked:C[B],half:C.halfCheck?C.halfCheck:(E.check.chkStyle==v.radio.STYLE?(C.check_Child_State===2):(C[B]?(C.check_Child_State>-1&&C.check_Child_State<2):(C.check_Child_State>0)))};return D},getTreeCheckedNodes:function(J,G,B,I){if(!G){return[]}var D=J.data.key.children,C=J.data.key.checked,H=(B&&J.check.chkStyle==v.radio.STYLE&&J.check.radioType==v.radio.TYPE_ALL);I=!I?[]:I;for(var E=0,F=G.length;E<F;E++){if(G[E].nocheck!==true&&G[E].chkDisabled!==true&&G[E][C]==B){I.push(G[E]);if(H){break}}w.getTreeCheckedNodes(J,G[E][D],B,I);if(H&&I.length>0){break}}return I},getTreeChangeCheckedNodes:function(H,F,G){if(!F){return[]}var C=H.data.key.children,B=H.data.key.checked;G=!G?[]:G;for(var D=0,E=F.length;D<E;D++){if(F[D].nocheck!==true&&F[D].chkDisabled!==true&&F[D][B]!=F[D].checkedOld){G.push(F[D])}w.getTreeChangeCheckedNodes(H,F[D][C],G)}return G},makeChkFlag:function(I,H){if(!H){return}var C=I.data.key.children,B=I.data.key.checked,D=-1;if(H[C]){for(var F=0,G=H[C].length;F<G;F++){var E=H[C][F];var J=-1;if(I.check.chkStyle==v.radio.STYLE){if(E.nocheck===true||E.chkDisabled===true){J=E.check_Child_State}else{if(E.halfCheck===true){J=2}else{if(E[B]){J=2}else{J=E.check_Child_State>0?2:0}}}if(J==2){D=2;break}else{if(J==0){D=0}}}else{if(I.check.chkStyle==v.checkbox.STYLE){if(E.nocheck===true||E.chkDisabled===true){J=E.check_Child_State}else{if(E.halfCheck===true){J=1}else{if(E[B]){J=(E.check_Child_State===-1||E.check_Child_State===2)?2:1}else{J=(E.check_Child_State>0)?1:0}}}if(J===1){D=1;break}else{if(J===2&&D>-1&&F>0&&J!==D){D=1;break}else{if(D===2&&J>-1&&J<2){D=1;break}else{if(J>-1){D=J}}}}}}}}H.check_Child_State=D}},i={},k={onCheckNode:function(D,E){if(E.chkDisabled===true){return false}var F=w.getSetting(D.data.treeId),B=F.data.key.checked;if(y.apply(F.callback.beforeCheck,[F.treeId,E],true)==false){return true}E[B]=!E[B];z.checkNodeRelation(F,E);var C=b(E,v.id.CHECK,F);z.setChkClass(F,C,E);z.repairParentChkClassWithSelf(F,E);F.treeObj.trigger(v.event.CHECK,[D,F.treeId,E]);return true},onMouseoverCheck:function(C,D){if(D.chkDisabled===true){return false}var E=w.getSetting(C.data.treeId),B=b(D,v.id.CHECK,E);D.check_Focus=true;z.setChkClass(E,B,D);return true},onMouseoutCheck:function(C,D){if(D.chkDisabled===true){return false}var E=w.getSetting(C.data.treeId),B=b(D,v.id.CHECK,E);D.check_Focus=false;z.setChkClass(E,B,D);return true}},q={},s={checkNodeRelation:function(K,G){var I,E,F,D=K.data.key.children,B=K.data.key.checked,J=v.radio;if(K.check.chkStyle==J.STYLE){var C=w.getRadioCheckedList(K);if(G[B]){if(K.check.radioType==J.TYPE_ALL){for(E=C.length-1;E>=0;E--){I=C[E];if(I[B]&&I!=G){I[B]=false;C.splice(E,1);z.setChkClass(K,b(I,v.id.CHECK,K),I);if(I.parentTId!=G.parentTId){z.repairParentChkClassWithSelf(K,I)}}}C.push(G)}else{var H=(G.parentTId)?G.getParentNode():w.getRoot(K);for(E=0,F=H[D].length;E<F;E++){I=H[D][E];if(I[B]&&I!=G){I[B]=false;z.setChkClass(K,b(I,v.id.CHECK,K),I)}}}}else{if(K.check.radioType==J.TYPE_ALL){for(E=0,F=C.length;E<F;E++){if(G==C[E]){C.splice(E,1);break}}}}}else{if(G[B]&&(!G[D]||G[D].length==0||K.check.chkboxType.Y.indexOf("s")>-1)){z.setSonNodeCheckBox(K,G,true)}if(!G[B]&&(!G[D]||G[D].length==0||K.check.chkboxType.N.indexOf("s")>-1)){z.setSonNodeCheckBox(K,G,false)}if(G[B]&&K.check.chkboxType.Y.indexOf("p")>-1){z.setParentNodeCheckBox(K,G,true)}if(!G[B]&&K.check.chkboxType.N.indexOf("p")>-1){z.setParentNodeCheckBox(K,G,false)}}},makeChkClass:function(H,F){var C=H.data.key.checked,B=v.checkbox,G=v.radio,E="";if(F.chkDisabled===true){E=B.DISABLED}else{if(F.halfCheck){E=B.PART}else{if(H.check.chkStyle==G.STYLE){E=(F.check_Child_State<1)?B.FULL:B.PART}else{E=F[C]?((F.check_Child_State===2||F.check_Child_State===-1)?B.FULL:B.PART):((F.check_Child_State<1)?B.FULL:B.PART)}}}var D=H.check.chkStyle+"_"+(F[C]?B.TRUE:B.FALSE)+"_"+E;D=(F.check_Focus&&F.chkDisabled!==true)?D+"_"+B.FOCUS:D;return v.className.BUTTON+" "+B.DEFAULT+" "+D},repairAllChk:function(I,B){if(I.check.enable&&I.check.chkStyle===v.checkbox.STYLE){var C=I.data.key.checked,D=I.data.key.children,H=w.getRoot(I);for(var E=0,F=H[D].length;E<F;E++){var G=H[D][E];if(G.nocheck!==true&&G.chkDisabled!==true){G[C]=B}z.setSonNodeCheckBox(I,G,B)}}},repairChkClass:function(D,C){if(!C){return}w.makeChkFlag(D,C);if(C.nocheck!==true){var B=b(C,v.id.CHECK,D);z.setChkClass(D,B,C)}},repairParentChkClass:function(D,B){if(!B||!B.parentTId){return}var C=B.getParentNode();z.repairChkClass(D,C);z.repairParentChkClass(D,C)},repairParentChkClassWithSelf:function(D,C){if(!C){return}var B=D.data.key.children;if(C[B]&&C[B].length>0){z.repairParentChkClass(D,C[B][0])}else{z.repairParentChkClass(D,C)}},repairSonChkDisabled:function(H,G,C,E){if(!G){return}var B=H.data.key.children;if(G.chkDisabled!=C){G.chkDisabled=C}z.repairChkClass(H,G);if(G[B]&&E){for(var D=0,F=G[B].length;D<F;D++){var I=G[B][D];z.repairSonChkDisabled(H,I,C,E)}}},repairParentChkDisabled:function(E,D,B,C){if(!D){return}if(D.chkDisabled!=B&&C){D.chkDisabled=B}z.repairChkClass(E,D);z.repairParentChkDisabled(E,D.getParentNode(),B,C)},setChkClass:function(D,C,B){if(!C){return}if(B.nocheck===true){C.hide()}else{C.show()}C.attr("class",z.makeChkClass(D,B))},setParentNodeCheckBox:function(J,G,L,K){var D=J.data.key.children,B=J.data.key.checked,C=b(G,v.id.CHECK,J);if(!K){K=G}w.makeChkFlag(J,G);if(G.nocheck!==true&&G.chkDisabled!==true){G[B]=L;z.setChkClass(J,C,G);if(J.check.autoCheckTrigger&&G!=K){J.treeObj.trigger(v.event.CHECK,[null,J.treeId,G])}}if(G.parentTId){var I=true;if(!L){var H=G.getParentNode()[D];for(var E=0,F=H.length;E<F;E++){if((H[E].nocheck!==true&&H[E].chkDisabled!==true&&H[E][B])||((H[E].nocheck===true||H[E].chkDisabled===true)&&H[E].check_Child_State>0)){I=false;break}}}if(I){z.setParentNodeCheckBox(J,G.getParentNode(),L,K)}}},setSonNodeCheckBox:function(I,H,L,K){if(!H){return}var D=I.data.key.children,B=I.data.key.checked,C=b(H,v.id.CHECK,I);if(!K){K=H}var E=false;if(H[D]){for(var F=0,G=H[D].length;F<G;F++){var J=H[D][F];z.setSonNodeCheckBox(I,J,L,K);if(J.chkDisabled===true){E=true}}}if(H!=w.getRoot(I)&&H.chkDisabled!==true){if(E&&H.nocheck!==true){w.makeChkFlag(I,H)}if(H.nocheck!==true&&H.chkDisabled!==true){H[B]=L;if(!E){H.check_Child_State=(H[D]&&H[D].length>0)?(L?2:0):-1}}else{H.check_Child_State=-1}z.setChkClass(I,C,H);if(I.check.autoCheckTrigger&&H!=K&&H.nocheck!==true&&H.chkDisabled!==true){I.treeObj.trigger(v.event.CHECK,[null,I.treeId,H])}}}},t={tools:q,view:s,event:i,data:h};a.extend(true,a.fn.zTree.consts,f);a.extend(true,a.fn.zTree._z,t);var A=a.fn.zTree,y=A._z.tools,v=A.consts,z=A._z.view,w=A._z.data,x=A._z.event,b=y.$;w.exSetting(p);w.addInitBind(e);w.addInitUnBind(r);w.addInitCache(l);w.addInitNode(m);w.addInitProxy(j,true);w.addInitRoot(n);w.addBeforeA(d);w.addZTreeTools(u);var g=z.createNodes;z.createNodes=function(F,C,D,E,B){if(g){g.apply(z,arguments)}if(!D){return}z.repairParentChkClassWithSelf(F,E)};var o=z.removeNode;z.removeNode=function(D,B){var C=B.getParentNode();if(o){o.apply(z,arguments)}if(!B||!C){return}z.repairChkClass(D,C);z.repairParentChkClass(D,C)};var c=z.appendNodes;z.appendNodes=function(I,E,F,H,C,D,G){var B="";if(c){B=c.apply(z,arguments)}if(H){w.makeChkFlag(I,H)}return B}})(jQuery);